Deformation to the Normal Cone
===

# An outline of blowup

## Blow-up algebra (Rees algebra)

Given a ring $R$ with ideal $I\subset R$, we define the blow-up algebra (Rees algebra) for $R$ at $I$ to be the $R$-graded algebra

$$ Bl_I(R)=R\oplus I\oplus I^2\oplus\cdots $$

where the summand $I^n$ is in degree $n$. Let $a\in I$ a (non-zero) element. Denote $a^{(1)}$ the exact element $a$  viewed as an element in degree $1$ in $Bl_I(R)$. Then we define the affine blowup algebra $R[\frac{I}{a}]$ to be the degree $0$ part of $Bl_I(R)[(a^{(1)})^{-1}]$. Namely, this is the ring of elements in the form of $x/a^n$ where $x\in I^n$. Two representatives $x/a^n$ and $y/a^m$ are equal if and only if $a^k(a^mx-a^ny)=0$ for some $k\geq 0$. There is a canonical morphism from $R$ to $R[\frac{I}{a}]$ in the trivial way, sending $a\in R$ to the element at degree $0$.

Following the notation, we have

- The image of $a$ in $R[\frac{I}{a}]$ is a non-zerodivisor.
- $IR[\frac{I}{a}]=aR[\frac{I}{a}]$.
- $R$ and $R[\frac{I}{a}]$ are isomorphic on local $D(a)$.

Proof. If $a\cdot(x/a^n)=0$ for some $x\in I^n$, we have $ax/(a^{n+1})=0$. Furthermore, $a^n\cdot(x/a^n)=x$ so $a$ generates $I$ in $R[\frac{I}{a}]$.



## Blow-up algebra as local structure of blowups

For a scheme $X$ together with an ideal sheaf $\mathcal{I}$ corresponding to a closed subscheme $Z\subset X$ we define the blowup of $X$ along the center $Z$ to be

$$ b:Proj_X(\oplus_{n\geq 0}\mathcal{I}^n)\rightarrow X. $$

The process of blowing up a scheme, in abstract sense, is to turn a chosen closed local into a *divisor*, that is, a locally principle ideal which is also an invertible sheaf. We can see this from the definition.

### [0804](https://stacks.math.columbia.edu/tag/0804)
Following the preceding notations, let $U=spec(A)$ be an affine open subscheme of $X$ and $I\subset A$ corresponding to $\mathcal{I}_U$. If $b:X'\rightarrow X$ is the blowup along closed local cut out by $\mathcal{I}$, then there is a canonical isomorphism

$$ b^{-1}(U)=Proj(\oplus_{d\geq 0}I^d) $$

identifying $b^{-1}(U)$ with the projective spectrum of Rees algebra $Bl_I(A)$. Moreover, $b^{-1}(U)$ have a covering by affine locals $D_+(a)$ where $a\in I$, which is identical to spectrum of $A[\frac{I}{a}]$. 

Specifically, according to the definition, blowing up along an empty subscheme $Z$ we may get $Proj_X(\mathcal{O}_X[t])$ which is just identical to $X$. Then using 0804 it's obvious that a blowup $b:X'\rightarrow X$ along $Z\subset X$ restricting to $X\backslash Z$ is $id$. From the properties of Rees algebra we know that the exceptional divisor, namely $b^{-1}Z$ is indeed an effective cartier divisor. 

### [0805](https://stacks.math.columbia.edu/tag/0805)
Moreover, blowup commutes with flat base change.

An interesting topic is Raynaud & Gruson's flatification by strict transformation. 

## R&G flatification
To be continued

# Deformation to the normal cone

## Some notations and facts

Following Fulton's notation, for a graded $\mathcal{O}_X$-algebra $S^\bullet=S^0\oplus S^1\oplus\cdots$ on a scheme $X$, such that the canonical map from $\mathcal{O}_X$ to $S^0$ is an isomorphism, and $S^\bullet$ is locally generated by sections of degree $1$, we associate the *cone* of $S^\bullet$

$$ C=Spec(S^\bullet) $$
 
with canonical projection $\pi:C\rightarrow X$, and the *projective cone*

$$ P(C)=Proj(S^\bullet) $$

with canonical projection $p:P(C)\rightarrow X$. 

Let $z$ be a free variable, $S^\bullet[z]$ the graded algebra whose nth graded piece is

$$ S^n\oplus S^{n-1}z\oplus\cdots\oplus S^1z^{n-1}\oplus S^0z^n. $$

The corresponding cone is denote $C\oplus 1$, and the cone $P(C\oplus 1)$ is called the projective completion of $C$. Now $z$ is a section in $\mathcal{O}(1)$ hence defines a hypersurface which is clearly isomorphic to $P(C)$, which is then called the *hyperplane at infinity*. Cutting out this subscheme, the rest part is $D_+(z)$ and hence the spectrum of algebra $S^0\oplus S^1/z\oplus S^2/z^2\oplus\cdots$, hence isomorphic to $C$. 

A vector bundlle $E\rightarrow X$ is the cone associated to the graded sheaf $Sym(\mathcal{E}^\vee)$, where $\mathcal{E}$ is the sheaf of sections of $E\rightarrow X$. The projective bundle of $\mathcal{E}$ is $P(E)=Proj(Sym\mathcal{E}^\vee)$. Under this notation, there is a canonical surjetion $p^*\mathcal{E}^\vee\rightarrow\mathcal{O}(1)$ on $P(E)$, which identifies $\mathcal{O}(-1)$ as a subsheaf of $p^*\mathcal{E}$, which is then called the *tautological line bundle* of $P(E)$. Given morphism $f:T\rightarrow X$, to factor $f$ through $p:P(E)\rightarrow X$ is equivalant to specify a line sub-bundle of $f^*\mathcal{E}$, namely the pullback of the tautological bundle of $P(E)$. 

Let $X$ be a subscheme of $Y$, defined by ideal sheaf $\mathcal{I}$. The *normal cone* $C_XY$ is the cone over $X$ defined by the graded $\mathcal{O}_X$ algebra $\oplus_{n\geq 0}\mathcal{I}^n/\mathcal{I}^{n+1}$. This construction commutes with flat base changes. If $X\rightarrow Y$ is a quasi-regular immersion of codimension $d$, the graded algebra is then isomorphic to $Sym(\mathcal{I}/\mathcal{I}^2)$, which is the associated vector bundle of the dual of $\mathcal{I}/\mathcal{I}^2$. We may denote the cone of $Sym(\mathcal{I}/\mathcal{I})$ by $N_XY$. Remember the blowup $b:Y'\rightarrow Y$ at $X$ is defined by $Proj(\oplus_{n\geq 0}\mathcal{I}^n)$, then the pullback of $X\rightarrow Y$ along the blowup, or namely the exceptional divisor, is then $\mathcal{O}(1)$, hence a cartesian divisor indeed. If we define by $E$ the exceptional divisor, then it's clear that $\mathcal{O}(E)$ is the dual invertible sheaf of $\mathcal{O}(1)$, hence isomorphic to $\mathcal{O}(-1)$.

If $Y$ is flat over a non-singular curve $T$, then $Bl_XY$ is also flat over $T$ for any subscheme $X$. Note that being flat over a DVR is equivalant to being *torsion free*. Assume that $T$ is a DVR, $\mathcal{O}_Y$ is therefore flat over $T$, hence an ideal sheaf $\mathcal{I}$ is flat over $T$. Then clearly blowup, which is locally a localization of $\oplus\mathcal{I}^n$, is flat over $T$.

## Deformation to the normal cone

For a subscheme $X$ of $Y$, define $M_XY$ of simply $M$ to be the blowup of $Y\times\mathbb{P}^1$ at $X\times\infty$. Namely, we has a commutative diagram 

```rawlatex
\begin{tikzcd}
	{X\times\mathbb{P}^1} && {M_XY} \\
	& {\mathbb{P}^1}
	\arrow["i", from=1-1, to=1-3]
	\arrow["pr"', from=1-1, to=2-2]
	\arrow["\rho", from=1-3, to=2-2]
\end{tikzcd}
```

The immersion $i$ is not that straightforward. To construct it, identify $X$ as the point at infinity of $X\times\mathbb{P}^1$, which is then embedded into $Y\times\mathbb{P}^1$. The blowup of $X\times\mathbb{P}^1$ at infininty is indentical to itself, hence the strict transformation gives the closed embedding $i$. Since $pr:Y\times\mathbb{P}^1\rightarrow\mathbb{P}^1$ is flat, the blowup $M_XY$ is flat over $\mathbb{P}^1$ with the associated morphism denoted by $\rho$. Since $M\rightarrow Y\times\mathbb{P}^1$ is an isomorphism if we cut out $Y\times\infty$, we see that

- $i$ is the trivial embedding away from $\infty$, namely $X\times\mathbb{A}^1\rightarrow Y\times\mathbb{A}^1$.

<!--
Now we investigate the structure over $\infty$. If we denote by $C$ the normal cone $C_XY$, the normal cone of $X\times\infty$ in $Y\times\mathbb{P}^1$ is $C\oplus 1$, therefore the exceptionh divisor of $M_XY$ is $P(C\oplus 1)$. Also view $Y'$, the blowup of $Y$ at $X$, as a closed subscheme of $M_XY$ via the embedding

```rawlatex
\begin{tikzcd}
	X\times\infty & Y\times\infty & {Y\times\mathbb{P}^1}
	\arrow[hook, from=1-1, to=1-2]
	\arrow[hook, from=1-2, to=1-3]
\end{tikzcd}
```

then the statement

- Over $\infty$, the divisor $M_\infty=\rho^{-1}(\infty)$ is the sum of two effective Cartier divisors $P(C\oplus 1)+Y'$

*should* holds. To see this we may check locally, 
-->

In the theory of $A^1$-homotopy, we hope to do such a deformation on section $0$ and $1$ over an affine line (dispite that, it's very stupid to do calculation over a projective base!). So here we cut off the $0$ point of $\mathbb{P}^1$ and identify it as $\mathbb{A}^1$ with $\infty$ as $0$. We denote by $M_XY'$ be $M_XY$ localized over $\mathbb{A}^1$.

If we denote by $\mathcal{I}\subset\mathcal{O}_Y$ the ideal cutting out $X$ inside $Y$, then the ideal cutting out $X\times 0$ in $Y\times\mathbb{A}^1$ is just $(\mathcal{I}[T]+(T))\subset\mathcal{O}_Y[T]$, so the morphism $M_XY\rightarrow Y\times\mathbb{A}^1$ is $Proj_{Y\times\mathbb{A}^1}(\oplus_{n\geq 0}(\mathcal{I}[T]+(T))^n)$. Then what's the exceptional divisor? We may illustrate this using some small tricks...

|   |   |   |   |   |
|---|---|---|---|---|
| x | x | x | x | x |
| x | x | x | x | x |
| x | x | x | x | x |
| o | x | x | x | x |

Going in vertical $\uparrow$ stands for $\mathcal{I}$ filtration and horizental $\rightarrow$ stands for $(T)$ filtration. Now this table depicts the ideal $\mathcal{J}:=\mathcal{I}[T]+(T)$. Then $\mathcal{J}^n$ is just the diagram with a size $n$ triangle at lower left corner, and the quotient $\mathcal{J}^n/\mathcal{J}^{n+1}$ is 

|   |   |   |   |   |
|---|---|---|---|---|
| o | o | o | o | o |
| x | o | o | o | o |
| o | x | o | o | o |
| o | o | x | o | o |

(for the case $n=2$). Namely this is $\oplus_{0\leq m\leq n}(\mathcal{I}^m/\mathcal{I}^{m+1})(T^{n-m})$, so the exceptional divisor of $M_XY'$ localized over $\mathbb{A}^1$ is just $P(C\oplus 1)$ where $C$ is the normal cone $C_XY$.

Now the only trouble is the fibre of $M_XY'$ over $0$ (or $\infty$ in our previous language). Namely this is the projective cone of $\oplus\mathcal{J}^n/T\mathcal{J}^n$ over $Y$, so using the depiction above we know that the slices of this graded algebra looks like


|   |   |   |   |   |
|---|---|---|---|---|
| x | o | o | o | o |
| x | o | o | o | o |
| x | o | o | o | o |
| x | o | o | o | o |
| o | x | o | o | o |
| o | o | x | o | o |

($n=2$ e.g.). Namely the slice at degree $n$ is $(\mathcal{I}^n\oplus\mathcal{I}^{n-1}/\mathcal{I}^n\oplus\cdots\oplus\mathcal{O}_Y/\mathcal{I})$. This projective cone has two obvious subschemes: the one associated to the left column, namely the blowup of $Y$ at $X$, and the tilt slice, namely $P(C\oplus 1)$ as what we has illustrated above. These two subschemes meet at the projective cone $P(C)$ which relates to the first non-empty block on the first column. Furthermore, these two closed subschemes are both cartier divisors if we view the fibre as a closed subscheme of $M_XY'$. This is obvious for the exceptional divisor, and it's straightforward that the embedded blowup is $(T)$ where $T$ viewed as a section of $\mathcal{O}(1)$.

